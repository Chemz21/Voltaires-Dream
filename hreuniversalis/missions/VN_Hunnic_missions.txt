#Hunnic/Khazar missions
#Contributed by RetrogMXII
#Coded by ShyGuy13

vn_hns_missions_slot_1 = {
    slot = 6
    generic = no
    ai = yes
    potential = {
        OR = {
			tag = HNS
			tag = KHZ
		}
        NOT = { map_setup = map_setup_random }
    }
    has_country_shield = yes

    vn_hns_hungarian_khazars = {
        icon = mission_unite_home_region
        position = 1
        required_missions = {  }
        provinces_to_highlight = {
            owned_by = HUN
        }
        trigger = {
            OR = {
                HUN = { exists = no }
                AND = {
                    alliance_with = HUN
                    reverse_has_opinion = {
                        who = HUN
                        value = 150
                    }
                }
                AND = {
                    is_rival = HUN
                    HUN = { has_been_insulted_by_root = yes }
                }
            }
        }
        effect = {
            add_country_modifier = {
                name = hns_hungarian_khazars_mission
                duration = 9125
            }
        }
    }
    vn_hns_conquer_hiberia = {
        icon = mission_unite_home_region
        position = 3
        required_missions = { vn_hns_conquer_alania }
        provinces_to_highlight = {
            region = hiberia_region
            NOT = { country_or_non_sovereign_subject_holds = ROOT }
        }
        trigger = {
            hiberia_region = {
                type = all
                country_or_non_sovereign_subject_holds = ROOT
            }
        }
        effect = {
            
        }
    }
    vn_hns_conquer_georgia = {
        icon = mission_have_two_subjects
        position = 4
        required_missions = { vn_hns_conquer_hiberia vn_hns_conquer_circassia }
        provinces_to_highlight = {
            region = georgia_region
            NOT = { country_or_non_sovereign_subject_holds = ROOT }
        }
        trigger = {
            georgia_region = {
                type = all
                country_or_non_sovereign_subject_holds = ROOT
            }
        }
        effect = {
            
        }
    }
    vn_hns_conquer_armenia = {
        icon = mission_unite_home_region
        position = 5
        required_missions = { vn_hns_conquer_georgia }
        provinces_to_highlight = {
            OR = {
                region = armenia_region
                region = tao_region
            }
            NOT = { country_or_non_sovereign_subject_holds = ROOT }
        }
        trigger = {
            armenia_region = {
                type = all
                country_or_non_sovereign_subject_holds = ROOT
            }
            tao_region = {
                type = all
                country_or_non_sovereign_subject_holds = ROOT
            }
        }
        effect = {
            add_country_modifier = {
                name = hns_conquer_armenia_mission
                duration = -1
            }
        }
    }
    vn_hns_defeat_the_caliphate = {
        icon = mission_crush_delhi
        position = 6
        required_missions = { vn_hns_conquer_armenia }
        provinces_to_highlight = {
            province_id = 6301
        }
        trigger = {
            OR = {
                6301 = { controlled_by = ROOT }
                custom_trigger_tooltip = {
                    tooltip = vn_hns_defeat_the_caliphate.tt
                    6301 = {
                        owner = {
                            NOT = { religion_group = muslim }
                        }
                    }
                }
            }
        }
        effect = {
            add_power_projection = {
                type = mission_rewards_power_projection
                amount = 30
            }
            add_country_modifier = {
                name = hns_defeat_the_caliphate_mission
                duration = 9125
            }
        }
    }
}

vn_hns_missions_slot_2 = {
    slot = 7
    generic = no
    ai = yes
    potential = {
        OR = {
			tag = HNS
			tag = KHZ
		}
        NOT = { map_setup = map_setup_random }
    }
    has_country_shield = yes

    vn_hns_conquer_alania = {
        icon = mission_unite_home_region
        position = 2
        required_missions = { vn_hns_khazarian_succession }
        provinces_to_highlight = {
            OR = {
                area = alania_area
                area = chechnya_area
            }
            NOT = { country_or_non_sovereign_subject_holds = ROOT }
        }
        trigger = {
            alania_area = {
                type = all
                country_or_non_sovereign_subject_holds = ROOT
            }
            chechnya_area = {
                type = all
                country_or_non_sovereign_subject_holds = ROOT
            }
        }
        effect = {
            
        }
    }
    vn_hns_conquer_circassia = {
        icon = mission_cossack_cavalry
        position = 3
        required_missions = { vn_hns_conquer_alania }
        provinces_to_highlight = {
            region = circassia_region
            NOT = { country_or_non_sovereign_subject_holds = ROOT }
        }
        trigger = {
            circassia_region = {
                type = all
                country_or_non_sovereign_subject_holds = ROOT
            }
        }
        effect = {
            add_country_modifier = {
                name = hns_conquer_circassia_mission
                duration = 9125
            }
        }
    }
    vn_hns_conquer_kuban = {
        icon = mission_unite_home_region
        position = 4
        required_missions = { vn_hns_conquer_circassia }
        provinces_to_highlight = {
            OR = {
                area = kuban_area
                area = taman_area
                area = krasnodar_area
            }
            NOT = { country_or_non_sovereign_subject_holds = ROOT }
        }
        trigger = {
            kuban_area = {
                type = all
                country_or_non_sovereign_subject_holds = ROOT
            }
            taman_area = {
                type = all
                country_or_non_sovereign_subject_holds = ROOT
            }
            krasnodar_area = {
                type = all
                country_or_non_sovereign_subject_holds = ROOT
            }
        }
        effect = {
            
        }
    }
    vn_hns_conquer_khopyr = {
        icon = mission_unite_home_region
        position = 5
        required_missions = { vn_hns_conquer_kuban vn_hns_conquer_lower_don }
        provinces_to_highlight = {
            OR = {
                region = khopyor_region
                region = sloboda_region
            }
            NOT = { country_or_non_sovereign_subject_holds = ROOT }
        }
        trigger = {
            khopyor_region = {
                type = all
                country_or_non_sovereign_subject_holds = ROOT
            }
            sloboda_region = {
                type = all
                country_or_non_sovereign_subject_holds = ROOT
            }
        }
        effect = {
            add_country_modifier = {
                name = hns_conquer_khopyr_mission
                duration = 9125
            }
        }
    }
    vn_hns_defeat_the_romans = {
        icon = mission_city_of_the_world's_desire
        position = 6
        required_missions = { vn_hns_conquer_khopyr vn_hns_conquer_armenia }
        provinces_to_highlight = {
            area = cherson_area
            NOT = { country_or_non_sovereign_subject_holds = ROOT }
        }
        trigger = {
            cherson_area = {
                type = all
                country_or_non_sovereign_subject_holds = ROOT
            }
            OR = {
                2233 = { controlled_by = ROOT }
                NOT = { exists = BYZ }
            }
        }
        effect = {
            add_power_projection = {
                type = mission_rewards_power_projection
                amount = 30
            }
            add_country_modifier = {
                name = hns_defeat_the_romans_mission
                duration = 9125
            }
        }
    }
}

vn_hns_missions_slot_3 = {
    slot = 8
    generic = no
    ai = yes
    potential = {
        OR = {
			tag = HNS
			tag = KHZ
		}
        NOT = { map_setup = map_setup_random }
    }
    has_country_shield = yes

    vn_hns_khazarian_succession = {
        icon = mission_chinese_general_riding
        position = 1
        required_missions = {  }
        trigger = {
            num_of_cities = 10
            prestige = 25
            is_at_war = no
        }
        effect = {
            if = {
                limit = {
                    tag = KHZ
                    is_free_or_tributary_trigger = yes
                    HNS = {
                        is_subject = no
                        NOT = { num_of_cities = 10 }
                    }
                }
                vassalize = HNS
            }
            else_if = {
                limit = {
                    tag = HNS
                    is_free_or_tributary_trigger = yes
                    KHZ = {
                        is_subject = no
                        NOT = { num_of_cities = 10 }
                    }
                }
                vassalize = HNS
            }
        }
    }
    vn_hns_conquer_astrakhan = {
        icon = mission_unite_home_region
        position = 2
        required_missions = { vn_hns_khazarian_succession }
        provinces_to_highlight = {
            area = astrakhan_area
            NOT = { country_or_non_sovereign_subject_holds = ROOT }
        }
        trigger = {
            astrakhan_area = {
                type = all
                country_or_non_sovereign_subject_holds = ROOT
            }
        }
        effect = {
            3785 = {
                move_capital_effect = yes
                add_base_manpower = 3
                add_province_modifier = {
                    name = hns_conquer_astrakhan_mission
                    duration = 9125
                }
            }
        }
    }
    vn_hns_conquer_lower_volga = {
        icon = mission_unite_home_region
        position = 3
        required_missions = { vn_hns_conquer_astrakhan }
        provinces_to_highlight = {
            region = lower_volga_region
            NOT = { country_or_non_sovereign_subject_holds = ROOT }
        }
        trigger = {
            lower_volga_region = {
                type = all
                country_or_non_sovereign_subject_holds = ROOT
            }
        }
        effect = {
            
        }
    }
    vn_hns_conquer_lower_don = {
        icon = mission_unite_home_region
        position = 4
        required_missions = { vn_hns_conquer_lower_volga }
        provinces_to_highlight = {
            OR = {
                region = lower_don_region
                area = pryazovia_area
                area = poltava_area
                area = maeotida_area
                area = qale_area
                area = qirim_area
            }
            NOT = { country_or_non_sovereign_subject_holds = ROOT }
        }
        trigger = {
            lower_don_region = {
                type = all
                country_or_non_sovereign_subject_holds = ROOT
            }
            pryazovia_area = {
                type = all
                country_or_non_sovereign_subject_holds = ROOT
            }
            poltava_area = {
                type = all
                country_or_non_sovereign_subject_holds = ROOT
            }
            maeotida_area = {
                type = all
                country_or_non_sovereign_subject_holds = ROOT
            }
            qale_area = {
                type = all
                country_or_non_sovereign_subject_holds = ROOT
            }
            qirim_area = {
                type = all
                country_or_non_sovereign_subject_holds = ROOT
            }
        }
        effect = {
            add_country_modifier = {
                name = hns_conquer_lower_don_mission
                duration = 9125
            }
        }
    }
    vn_hns_conquer_lower_dnieper = {
        icon = mission_advance_to_the_dnieper
        position = 5
        required_missions = { vn_hns_conquer_lower_don }
        provinces_to_highlight = {
            region = wild_fields_region
            NOT = { country_or_non_sovereign_subject_holds = ROOT }
        }
        trigger = {
            wild_fields_region = {
                type = all
                country_or_non_sovereign_subject_holds = ROOT
            }
        }
        effect = {
            
        }
    }
    vn_hns_defeat_the_rus = {
        icon = mission_steppe_warriors
        position = 6
        required_missions = { vn_hns_conquer_khopyr vn_hns_conquer_lower_dnieper }
        provinces_to_highlight = {
            if = {
                limit = {
                    any_country = {
                        is_emperor_of_china = yes
                        NOT = { tag = ROOT }
                    }
                }
                owner = {
                    is_emperor_of_china = yes
                }
            }
            else = {

            }
        }
        trigger = {
            OR = {
                is_emperor_of_china = yes
                custom_trigger_tooltip = {
                    tooltip = no_country_is_EoC
                    NOT = {
                        any_country = {
                            is_emperor_of_china = yes
                        }
                    }
                }
            }
        }
        effect = {
            add_power_projection = {
                type = mission_rewards_power_projection
                amount = 30
            }
            add_country_modifier = {
                name = hns_defeat_the_rus_mission
                duration = 9125
            }
        }
    }
    vn_hns_the_northern_kingdom = {
        icon = mission_empire
        position = 7
        required_missions = { vn_hns_defeat_the_caliphate vn_hns_defeat_the_romans vn_hns_defeat_the_rus vn_hns_defeat_the_mongols }
        trigger = {
            is_great_power = yes
            total_development = 1000
            all_rival_country = {
				NOT = {
					army_strength = {
						who = ROOT
						value = 1.0
					}
				}
			}
            if = {
                limit = { has_dlc = "Mandate of Heaven" }
                num_of_banners = 25
            }
            else = {
                army_size = 50
            }
            if = {
                limit = { has_estate = estate_nomadic_tribes }
                estate_loyalty = {
                    estate = estate_nomadic_tribes
                    loyalty = 60
                }
            }
        }
        effect = {
            if = {
                limit = { NOT = { government_rank = 6 } }
                set_government_rank = 6
            }
            add_adm_power = 100
            add_dip_power = 100
            add_mil_power = 100
            add_country_modifier = {
                name = hns_the_northern_kingdom_mission
                duration = 36500
            }
        }
	}
}

vn_hns_missions_slot_4 = {
    slot = 9
    generic = no
    ai = yes
    potential = {
        OR = {
			tag = HNS
			tag = KHZ
		}
        NOT = { map_setup = map_setup_random }
    }
    has_country_shield = yes

    vn_hns_conquer_derbent = {
        icon = mission_unite_home_region
        position = 2
        required_missions = { vn_hns_khazarian_succession }
        provinces_to_highlight = {
            OR = {
                area = derbent_area
                area = lekia_area
            }
            NOT = { country_or_non_sovereign_subject_holds = ROOT }
        }
        trigger = {
            derbent_area = {
                type = all
                country_or_non_sovereign_subject_holds = ROOT
            }
            lekia_area = {
                type = all
                country_or_non_sovereign_subject_holds = ROOT
            }
        }
        effect = {
            
        }
    }
    vn_hns_conquer_azerbaijan = {
        icon = mission_persian_soldiers
        position = 3
        required_missions = { vn_hns_conquer_derbent }
        provinces_to_highlight = {
            region = azerbaijan_region
            NOT = { country_or_non_sovereign_subject_holds = ROOT }
        }
        trigger = {
            azerbaijan_region = {
                type = all
                country_or_non_sovereign_subject_holds = ROOT
            }
        }
        effect = {
            
        }
    }
    vn_hns_conquer_kazakhstan = {
        icon = mission_central_asian_city
        position = 4
        required_missions = { vn_hns_conquer_lower_volga vn_hns_conquer_azerbaijan }
        provinces_to_highlight = {
            region = kazakhstan_region
            NOT = { country_or_non_sovereign_subject_holds = ROOT }
        }
        trigger = {
            kazakhstan_region = {
                type = all
                country_or_non_sovereign_subject_holds = ROOT
            }
        }
        effect = {
            
        }
    }
    vn_hns_conquer_volga_bulgaria = {
        icon = mission_non-western_cavalry_raid
        position = 5
        required_missions = { vn_hns_conquer_kazakhstan }
        provinces_to_highlight = {
            OR = {
                area = erzya_area
                area = bolghar_area
            }
            NOT = { country_or_non_sovereign_subject_holds = ROOT }
        }
        trigger = {
            erzya_area = {
                type = all
                country_or_non_sovereign_subject_holds = ROOT
            }
            bolghar_area = {
                type = all
                country_or_non_sovereign_subject_holds = ROOT
            }
        }
        effect = {
            add_country_modifier = {
                name = hns_conquer_volga_bulgaria_mission
                duration = 9125
            }
        }
    }
    vn_hns_defeat_the_mongols = {
        icon = mission_impaled_soldies
        position = 6
        required_missions = { vn_hns_conquer_volga_bulgaria }
        provinces_to_highlight = {
            region = khwarezmia_region
            NOT = { country_or_non_sovereign_subject_holds = ROOT }
        }
        trigger = {
            NOT = { current_age = age_of_empire }
			NOT = { current_age = age_of_holy_wars }
            NOT = { current_age = age_of_crisis }
            NOT = { exists = GLH }
            khwarezmia_region = {
                type = all
                country_or_non_sovereign_subject_holds = ROOT
            }
        }
        effect = {
            add_power_projection = {
                type = mission_rewards_power_projection
                amount = 30
            }
            add_country_modifier = {
                name = hns_defeat_the_mongols_mission
                duration = 9125
            }
        }
    }
}

vn_hns_missions_slot_5 = {
    slot = 10
    generic = no
    ai = yes
    potential = {
		OR = {
			tag = HNS
			tag = KHZ
		}
        NOT = { map_setup = map_setup_random }
    }
    has_country_shield = yes

    vn_hns_stable_horde = {
        icon = mission_high_income
        position = 1
        required_missions = {  }
        trigger = {
            stability = 1
            if = {
                limit = { has_dlc = "The Cossacks" }
                OR = {
                    NOT = { has_reform = steppe_horde }
                    AND = {
                        horde_unity = 100
                        OR = {
                            has_reform = horde_barbaric_despoilers_reform
                            has_reform = horde_tribal_unity_reform
                        }
                    }
                }
            }
            else = {
                limit = { has_dlc = "The Cossacks" }
                OR = {
                    NOT = { has_reform = steppe_horde }
                    AND = {
                        legitimacy = 100
                        OR = {
                            has_reform = horde_barbaric_despoilers_reform
                            has_reform = horde_tribal_unity_reform
                        }
                    }
                }
            }
        }
        effect = {
            add_country_modifier = {
                name = hns_stable_horde_mission
                duration = 9125
            }
        }
    }
    vn_hns_reaffirm_judaism = {
        icon = mission_hands_praying
        position = 3
        required_missions = { vn_hns_stable_horde }
        trigger = {
            has_regency = no
            all_core_province = {
                owned_by = ROOT
            }
            any_owned_province = {
                NOT = { religion = jewish }
            }
        }
        effect = {
            if = {
                limit = { religion = jewish }
                country_event = {
                    id = vn_missions.45
                }
            }
            else = {
                add_prestige = 20
            }
        }
    }
    vn_hns_asian_trade = {
        icon = mission_dominate_trade_in_bengal
        position = 5
        required_missions = { vn_hns_reaffirm_judaism vn_hns_conquer_kazakhstan }
        provinces_to_highlight = {
            OR = {
                province_id = 3785
                province_id = 6232
                province_id = 3577
            }
            NOT = { is_strongest_trade_power = ROOT }
        }
        trigger = {
            3785 = { is_strongest_trade_power = ROOT }
            6232 = { is_strongest_trade_power = ROOT }
            3577 = { is_strongest_trade_power = ROOT }
        }
        effect = {
            add_mercantilism = 5
            add_country_modifier = {
                name = hns_asian_trade_mission
                duration = 9125
            }
        }
    }
}